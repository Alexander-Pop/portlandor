/*
** Cloudy Design System Typography
**
** This file includes various helper functions, mixins, and maps that help to create the unified
** typography approach within the Cloudy design system.
*/

/*
** Helpers functions & mixins
*/

// Create the heading font sizes
@include create-heading-type-scale(major-second);

/// Remove the unit of a length
@function strip-unit($number) {
  @if type-of($number) == "number" and not unitless($number) {
    @return $number / ($number * 0 + 1);
  }

  @return $number;
}

/*
** Maps
*/

// Default heading styles
$cloudy-heading-style-default: (
  default: (
    font-weight: 500,
    font-family: $cloudy-font-family-prototype
  )
);

// heading type styles
$cloudy-heading-style-1: (
  xs: (
    font-size: calc(#{strip-unit($cloudy-type-heading-01-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-01-line-height)} / #{strip-unit($cloudy-type-heading-01-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-type-heading-01-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-01-md-line-height)} / #{strip-unit($cloudy-type-heading-01-md-font-size)})
  )
);

$cloudy-heading-style-2: (
  xs: (
    font-size: calc(#{strip-unit($cloudy-type-heading-02-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-02-line-height)} / #{strip-unit($cloudy-type-heading-02-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-type-heading-02-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-02-md-line-height)} / #{strip-unit($cloudy-type-heading-02-md-font-size)})
  )
);

$cloudy-heading-style-3: (
  xs: (
    font-size: calc(#{strip-unit($cloudy-type-heading-03-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-03-line-height)} / #{strip-unit($cloudy-type-heading-03-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-type-heading-03-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-03-md-line-height)} / #{strip-unit($cloudy-type-heading-03-md-font-size)})
  )
);

$cloudy-heading-style-4: (
  xs: (
    font-size: calc(#{strip-unit($cloudy-type-heading-04-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-04-line-height)} / #{strip-unit($cloudy-type-heading-04-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-type-heading-04-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-04-md-line-height)} / #{strip-unit($cloudy-type-heading-04-md-font-size)})
  )
);

$cloudy-heading-style-5: (
  xs: (
    font-size: calc(#{strip-unit($cloudy-type-heading-05-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-05-line-height)} / #{strip-unit($cloudy-type-heading-05-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-type-heading-05-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-05-md-line-height)} / #{strip-unit($cloudy-type-heading-05-md-font-size)})
  )
);

$cloudy-heading-style-6: (
  xs: (
    font-size: calc(#{strip-unit($cloudy-type-heading-06-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-06-line-height)} / #{strip-unit($cloudy-type-heading-06-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-type-heading-06-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-heading-06-md-line-height)} / #{strip-unit($cloudy-type-heading-06-md-font-size)})
  )
);

// Paragraph type styles
$cloudy-body-text-style: (
  default: (
    font-weight: 400,
    font-family: $cloudy-font-family-prototype
  ),
  xs: (
    font-size: calc(#{strip-unit($cloudy-type-body-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-body-line-height)} / #{strip-unit($cloudy-type-body-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-type-body-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-type-body-md-line-height)} / #{strip-unit($cloudy-type-body-md-font-size)})
  )
);

$cloudy-lead-text-style: (
  default: (
    font-weight: 300,
    font-family: $cloudy-font-family-prototype
  ),
  xs: (
    font-size: calc(#{strip-unit($cloudy-lead-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-lead-line-height)} / #{strip-unit($cloudy-lead-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-lead-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-lead-md-line-height)} / #{strip-unit($cloudy-lead-md-font-size)})
  )
);

$cloudy-helper-text-style: (
  default: (
    font-weight: 300,
    font-family: $cloudy-font-family-prototype
  ),
  xs: (
    font-size: calc(#{strip-unit($cloudy-helper-text-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-helper-text-line-height)} / #{strip-unit($cloudy-helper-text-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-helper-text-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-helper-text-md-line-height)} / #{strip-unit($cloudy-helper-text-md-font-size)})
  )
);

$cloudy-subtitle-text-style: (
  default: (
    font-weight: 300,
    font-family: $cloudy-font-family-prototype
  ),
  xs: (
    font-size: calc(#{strip-unit($cloudy-subtitle-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-subtitle-line-height)} / #{strip-unit($cloudy-subtitle-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-subtitle-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-subtitle-md-line-height)} / #{strip-unit($cloudy-subtitle-md-font-size)})
  )
);

$cloudy-ui-text-style: (
  default: (
    font-weight: 400,
    font-family: $cloudy-font-family-prototype
  ),
  xs: (
    font-size: calc(#{strip-unit($cloudy-ui-text-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-ui-text-line-height)} / #{strip-unit($cloudy-ui-text-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-ui-text-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-ui-text-md-line-height)} / #{strip-unit($cloudy-ui-text-md-font-size)})
  )
);

$cloudy-link-text-style: (
  default: (
    font-weight: 400,
    font-family: $cloudy-font-family-prototype
  ),
  xs: (
    font-size: calc(#{strip-unit($cloudy-link-text-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-link-text-line-height)} / #{strip-unit($cloudy-link-text-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-link-text-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-link-text-md-line-height)} / #{strip-unit($cloudy-link-text-md-font-size)})
  )
);

$cloudy-permalink-text-style: (
  default: (
    font-weight: 300,
    font-family: $cloudy-font-family-prototype
  ),
  xs: (
    font-size: calc(#{strip-unit($cloudy-permalink-text-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-permalink-text-line-height)} / #{strip-unit($cloudy-permalink-text-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-permalink-text-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-permalink-text-md-line-height)} / #{strip-unit($cloudy-permalink-text-md-font-size)})
  )
);

$cloudy-time-text-style: (
  default: (
    font-weight: 500,
    font-family: $cloudy-font-family-prototype
  ),
  xs: (
    font-size: calc(#{strip-unit($cloudy-time-text-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-time-text-line-height)} / #{strip-unit($cloudy-time-text-font-size)})
  ),
  md: (
    font-size: calc(#{strip-unit($cloudy-time-text-md-font-size)} / #{strip-unit($cloudy-type-base-font-size)}) + rem,
    line-height: calc(#{strip-unit($cloudy-time-text-md-line-height)} / #{strip-unit($cloudy-time-text-md-font-size)})
  )
);

// Merge default and heading style maps
$cloudy-heading-1: map-merge($cloudy-heading-style-default, $cloudy-heading-style-1);
$cloudy-heading-2: map-merge($cloudy-heading-style-default, $cloudy-heading-style-2);
$cloudy-heading-3: map-merge($cloudy-heading-style-default, $cloudy-heading-style-3);
$cloudy-heading-4: map-merge($cloudy-heading-style-default, $cloudy-heading-style-4);
$cloudy-heading-5: map-merge($cloudy-heading-style-default, $cloudy-heading-style-5);
$cloudy-heading-6: map-merge($cloudy-heading-style-default, $cloudy-heading-style-6);

// Convenience methods
$cloudy-lead-text: $cloudy-lead-text-style;
$cloudy-body-text: $cloudy-body-text-style;
$cloudy-helper-text: $cloudy-helper-text-style;
$cloudy-subtitle-text: $cloudy-subtitle-text-style;
$cloudy-ui-text: $cloudy-ui-text-style;
$cloudy-link-text: $cloudy-link-text-style;
$cloudy-permalink-text: $cloudy-permalink-text-style;
$cloudy-time-text: $cloudy-time-text-style;

// Generate type style from map values
@mixin make-type-style($type-style-values, $heading-prototype) {
  @if $heading-prototype == false {
    font-family: $cloudy-font-family-display;
    font-weight: 400;
  } @else {
    letter-spacing: map-get($type-style-values, letter-spacing);
    margin: map-get($type-style-values, margin);
    text-transform: map-get($type-style-values, text-transform);
    font-family: map-get($type-style-values, font-family);
    font-size: map-get($type-style-values, font-size);
    line-height: map-get($type-style-values, line-height);
    font-weight: map-get($type-style-values, font-weight);
  }
}

// heading-type passes in the heading variation
@mixin type-style($heading-type, $heading-breakpoints: $grid-breakpoints, $heading-prototype: false) {
  // Each breakpoint map in the heading variation
  @each $heading-breakpoint, $type-style-values in $heading-type {
    // if the map == default-, print map contents
    @if $heading-breakpoint == default {
      @include make-type-style($type-style-values, $heading-prototype);
    } @else {
      // if the heading variation has a breakpoint map that matches the breakpoints, get the breakpoint
      @if map-has-key($heading-breakpoints, $heading-breakpoint) {
        $heading-breakpoint: map-get($heading-breakpoints, $heading-breakpoint);
        // Apply breakpoint to media query and print the map's contents
        @media screen and (min-width: $heading-breakpoint) {
          @include make-type-style($type-style-values, $heading-prototype);
        }
      }
    }
  }
}

/*
** Cloudy Typography Implementation
**
** The below declarations apply the appropriate styling across global site elements
*/

html {
  font-size: $cloudy-type-base-font-size;

  @include media-breakpoint-up(md) {
    font-size: $cloudy-type-base-md-font-size;
  }
}

// Heading styles
h1,
.cloudy-h1 {
  @include type-style($cloudy-heading-1);
  // @include type-style($cloudy-heading-1, $heading-prototype: true); // Example for including the prototype font-face
}

h2,
.cloudy-h2 {
  @include type-style($cloudy-heading-2);
}

h3,
.cloudy-h3 {
  @include type-style($cloudy-heading-3);
}

h4,
.cloudy-h4 {
  @include type-style($cloudy-heading-4);
}

h5,
.cloudy-h5 {
  @include type-style($cloudy-heading-5);
}

h6,
.cloudy-h6 {
  @include type-style($cloudy-heading-6);
}

body {
  @include type-style($cloudy-body-text);
}

p,
.cloudy-p {
  @include type-style($cloudy-body-text);
}

a {
  @include type-style($cloudy-link-text);
}

/*
** Helper classes
*/

.cloudy-p {
  @include type-style($cloudy-body-text, $heading-prototype: true);
}

.cloudy-lead-text {
  @include type-style($cloudy-lead-text, $heading-prototype: true);
}

.cloudy-subtitle-text {
  @include type-style($cloudy-subtitle-text, $heading-prototype: true);
}

.cloudy-helper-text {
  @include type-style($cloudy-helper-text, $heading-prototype: true);
}

.cloudy-permalink {
  @include type-style($cloudy-permalink-text, $heading-prototype: true);
}

.cloudy-time {
  @include type-style($cloudy-time-text, $heading-prototype: true);
}

.cloudy-ui {
  @include type-style($cloudy-ui-text, $heading-prototype: true);
}

.cloudy-link {
  @include type-style($cloudy-link-text, $heading-prototype: true);
}
